import requests
import pymysql
import xlsxwriter
import time
import datetime
import cx_Oracle


url = 'http://product.pre.xinfangsheng.com/sysback/supplyareaprice/getListBySkuNos?menuId=289&buttonId=167'
header = {'Accept': 'application/json, text/plain, */*',
          'Content-Type': 'application/json;charset=UTF-8',
          'Cookie':'uc_token=93856f52d9aa4e19b8df3adc7c95d82a'}
data = {"skuNos":["014678","11211039","11989432","13539692","13616813","13616816","15000002","15000028","15001057","15001058","15002108","15006697","15006698","15006702","15006705","15007002","15007003","15007004","15007005","15007116","15007158","15007208","15007209","15007273","15007325","15007358","15007383","15009604","15010060","15010358","15010402","15010523","15011055","15011056","15011057","15011058","15011131","15011315","15011332","15011367","15011418","15012052","15012151","15012155","15012175","15012320","15012323","15012353","15012417","15012610","15012611","15013123","15013273","15013327","15013336","15013337","15013363","15013385","15013390","15013391","15013393","15013406","15013458","15013480","15013493","15013494","15013516","15013517","15013529","15013721","15013722","15013725","15013752","15013753","15013754","15013755","15013756","15013757","15013760","15013761","15013767","15013768","15013792","15013800","15013925","15013926","15013986","15014095","15014435","15014441","15014463","15014536","15014564","15014572","15014573","15014575","15014576","15014743","15014777","15014778","15014997","15015037","15015038","15021044","15021052","15022068","15022103","15022112","15023448","15023461","15023470","15023471","15023472","15023473","15023474","15023475","15023476","15023477","15023478","15023485","15023583","15023584","15023585","15023591","15023592","15023593","15023594","15023595","15023600","15023607","15023666","15028031","15029051","15029072","15029199","15029246","15031295","15031305","15031306","15035434","15038598","15044154","15044160","15044257","15044278","15044282","15044304","15044307","15044315","15044325","15044329","15044334","15044340","15044342","15044510","15044511","15044512","15044538","15044539","15044540","15044541","15044542","15044543","15044560","15044648","15044653","15044654","15044655","15044664","15044665","15044668","15044669","15044670","15044671","15044672","15044673","15044674","15044677","15044678","15044679","15044680","15044681","15044682","15044683","15044684","15044685","15044686","15044687","15044688","15044689","15044690","15044691","15044692","15044693","15044694","15044696","15044697","15044698","15044699","15044700","15044701","15044703","15044704","15044706","15044707","15044708","15044709","15044714","15044715","15044716","15044718","15044719","15044720","15044721","15044722","15044723","15044724","15044725","15044726","15044729","15044730","15044731","15044733","15044734","15044735","15044736","15044739","15044740","15044741","15044742","15044743","15044744","15044747","15044748","15044749","15044750","15044751","15044754","15044755","15044756","15044757","15044758","15044759","15044760","15044761","15044762","15044763","15044764","15044765","15044768","15044769","15044770","15044772","15044773","15044776","15044777","15044778","15044779","15044780","15044781","15044782","15044783","15044784","15044786","15044787","15044789","15044790","15044797","15044798","15044799","15044800","15044801","15044802","15044803","15044804","15044805","15044806","15044808","15044809","15044810","15044811","15044812","15044822","15044823","15044824","15044825","15044826","15044827","15044829","15044830","15044831","15044832","15044833","15044834","15044835","15044836","15044837","15044839","15044840","15044841","15044842","15044843","15044844","15044848","15044849","15044853","15044854","15044855","15044857","15044858","15044859","15044860","15044861","15044862","15044863","15044864","15044865","15044866","15044867","15044868","15044869","15044870","15044872","15044873","15044874","15044875","15044877","15044879","15044880","15044881","15044884","15044885","15044886","15044887","15044888","15044889","15044890","15044891","15044893","15044894","15044895","15044896","15044897","15044898","15044899","15044900","15044901","15044902","15044905","15044907","15044908","15044909","15044910","15044911","15044912","15044913","15044914","15044915","15044917","15044918","15044919","15044920","15044921","15044922","15044923","15044924","15044925","15044926","15044927","15044928","15044929","15044930","15044931","15044932","15044933","15044934","15044935","15044936","15044937","15044938","15044940","15044941","15044942","15044943","15044944","15044946","15044947","15044948","15044949","15044950","15044951","15044952","15044953","15044954","15044955","15044956","15044961","15044962","15044964","15044965","15044966","15044967","15044968","15044970","15044971","15044972","15044973","15044974","15044976","15044977","15044978","15044979","15044980","15044981","15044982","15044983","15045345","15045346","15045347","15045348","15049203","15049204","000849","10302592","10308499","055632","003745","055574","10313764","10302370","10731794","055516","001004","10240263","10309038","10731855","10308661","10309053","10302575","055211","10313849","10302516","10302287","044785","10308623","11278453","11278361","11278324","10308785","10372573","055301","10731874","10302507","10308458","10308503","055691","10731882","10313462","10309087","10313437","000359","11278399","000394","10308858","10352311","11278426","11278288","11278277","10308527","10308983","10313480","044818","10313532","10313752","10240187","10731778","044789","10308645","10313827","055572","10308621","10302542","055354","10240237","13241333","10240160","003751","11278372","10302344","10240169","10372531","10313760","10308969","10302598","055173","10308551","055656","10309079","10302548","001436","055536","003770","10302286","10240196","10313890","003230","11038073","10302505","11278290","10240216","10308540","055491","10313756","11278449","055770","052045","10313311","10308563","11278285","11038069","10352396","10240198","11278274","10313837","000895","10352395","10352418","055203","10302413","10137188","000449","10731856","10308804","10731779","10309056","10308706","055646","10302607","10308831","10731837","10308953","055157","10240267","10313299","10313895","11278271","10313794","10313413","042639","000853","10308887","10731770","10308862","001706","11278334","10240291","10313387","10313728","10308703","10309140","10302296","10308968","052036","10308859","10302605","10240158","10302524","10302277","10308447","055256","001433","10731851","13813569","10308401","10240254","055292","10240164","055580","10313397","055168","000812","10731864","10372551","055334","055686","10302445","10308469","10302300","10302494","10302435","055314","10313513","10308595","055470","10308895","046871","10302596","001705","10313505","11278419","10352310","11278310","10313439","10309143","055631","10308727","10302308","10302271","10313529","055721","10302508","055284","10313868","055670","10302593","11278392","055545","11278410","10313421","10302482","10309029","044783","10309032","10308660","001423","10302458","10302504","10308881","000404","10309151","10308406","055508","10731760","13467547","055436","003321","055368","000572","055166","10313781","10313346","10731835","055448","000401","10308396","10313351","10302525","003827","10313315","10313876","10313454","10302564","10313481","10313786","10137204","10240309","10313820","10309013","10240204","10313793","10308555","055600","10372537","10309126","12881692","055750","10309081","10313322","000819","055252","10309055","10313737","055449","10313783","10302568","055296","055443","10308781","000414","055263","10308751","055556","10308539","001432","000864","10308846","10313484","055521","10309017","055214","052039","10308475","055608","12985666","10731875","000454","10352428","10302521","10308871","10308972","055740","12984116","10302257","10240316","10313429","10240203","10308620","10308832","10240208","001012","10137237","10308980","055479","10308843","10372554","10308961","000571","003740","10372565","10352294","10240168","10313362","10313520","000845","10308597","10308658","055570","10313889","055698","10313746","10309030","11278322","10313527","000363","10302474","10240261","13467537","10313446","11278431","10313353","10352357","11038086","000888","055160","000613","10313733","10313305","10308408","055554","11278459","10352359","11278331","10313750","10309068","10731805","10302400","10302298","10302362","10731791","055440","055553","055494","10352412","003325","10372532","10240304","10308441","10313418","10313703","001015","10308838","055302","10352427","10352363","10731857","10308605","055712","10302423","10308763","10302492","10309028","11278455","10302455","10352419","10308792","10308550","055680","10731868","001382","10308974","10313309","11278363","10240260","10302484","10313717","10308448","10731888","13813568","10309127","10308812","10313324","10302441","10731827","10308975","10731841","055308","11278390","10309052","11278306","11278273","10309039","055559","10308449","10302518","10308900","10308405","10240189","001628","10308866","11278262","10308598","11278413","10309083","10308970","055414","10313393","055167","10240220","055626","055561","10308802","10352433","10313483","055300","10313535","10313359","001584","10240179","055465","055344","10372612","000916","10309062","10313300","10313304","10308394","001390","10308949","000897","10352340","000879","11278403","10308410","10313333","055767","055502","13467542","000876","11278450","10309054","10308898","055722","003743","10302310","055282","000396","10308855","10309131","10731883","001014","10137182","10313723","055289","10313414","10308553","10302314","10731858","043520","055555","10313399","044802","10308945","10309102","11278370","13241342","10313427","10308624","10302589","000448","10313342","055685","10308603","10240271","10308561","10731832","10308575","10302457","055303","10240256","003323","10372596","001469","10308443","10731820","055441","10308467","10731757","10313825","055690","11278269","10302250","10731801","10313769","10352393","000847","11278321","13241328","000813","10308513","000806","10309095","10302224","10313335","055738","001005","10240235","055297","10308929","11278382","10309063","10240278","10302543","055714","10313525","055305","13241343","10372519","10313887","10313340","10313853","001420","10313766","10308626","10302234","10309031","044798","10352330","055603","11278429","10308828","10308845","10313852","10313810","10313538","055487","10308439","10302420","10302487","10302381","10309014","055268","10313412","10308583","10302526","000872","10309145","10372539","055444","10308952","000936","10137246","001104","10313545","001707","10302290","10308786","10302411","001708","10309150","000403","11278289","000837","10313334","10240152","10731862","001521","10313491","10309129","10240157","10302305","003734","000453","10372569","000431","000831","10313341","044796","10313448","10240301","10313450","10308736","052046","10309058","055624","055560","10731879","001078","055358","001405","10302349","10302307","10302251","10313809","13241335","10309023","10240228","10372584","10372538","11278291","10240176","10352297","10308411","11278448","055749","055558","001585","055383","10308709","11278297","10731822","10313308","10372523","10308600","055248","10313470","10309144","055766","10308614","10309035","055209","10302469","10308593","10313423","10308819","055195","055396","10313328","10302359","055320","10352293","10313736","10240178","10313707","10308488","10137231","055428","10308455","055380","10309076","10240313","10313882","10313704","10309117","055247","10308423","003737","055278","052042","10309099","10352358","000852","10308456","10308537","10313521","10372583","10308721","10313364","10308864","000410","003754","11278427","10313780","10313533","10302232","10731803","055541","001409","10308611","003778","10302249","055446","10308773","10308473","10308630","10352350","13467533","10308932","10731839","003738","10308911","10309078","055567","001444","055234","11278309","10309108","001508","10308806","10308649","10137234","10352372","10731821","11278369","055402","10302536","000441","10302531","10302557","10302449","10352425","10309097","10302289","001211","10313519","001016","11020504","10308725","10731859","055422","001583","10731764","10240192","10352423","10313534","10302378","10309004","11278438","000801","10308885","001437","055264","10302267","10308922","10352389","000489","10313708","055341","10308500","044787","10313515","000216","10313400","10313317","10313441","10137233","11278386","055190","055270","055172","055511","11278362","10240243","055515","10313425","10731813","044948","10313347","055503","10308821","10313518","10308696","10137205","044069","001419","055321","10302510","10313512","10302253","044811","10313839","10313774","10302448","055607","055311","055196","10731889","055345","10313396","10731838","000450","10313455","10313872","055664","10308533","10308939","10308472","10302284","10731886","10352299","10308818","10308462","10308994","10302471","10308893","10731786","003727","11278394","12714544","000899","001408","10137183","10731752","055748","10240230","003756","10309042","015605","10308549","055187","10731765","000923","10308594","10309134","10352326","055386","10302587","10313316","10731893","10302440","10137192","10308588","003320","044792","11278443","000946","10240269","10137214","001013","10308508","10309137","10372579","10313551","055197","10137211","10302468","055707","055336","11278464","10308957","10302497","10731790","10352351","10308572","10308484","10313528","10308807","10731756","10308480","10313886","10308617","10313543","055506","10313830","10313873","10352337","10302545","10302561","10731810","10308715","000948","10308440","000854","055445","10352392","10308993","10240247","10240251","10313860","055650","11278272","11278418","10308692","055509","13813566","10308629","10240233","10302379","003766","055703","10313453","10308548","055538","10308686","10302600","10308677","10308894","10240265","11278320","10309169","10240211","10308924","055654","10308565","10309133","10240219","10308884","10313850","10302599","10352347","055642","10313817","10302399","10309043","10309046","10308668","044946","10352329","10308648","10309113","055622","10308903","055633","055419","10240150","10313775","000446","10302228","10308867","10352361","10308599","10731885","055672","10372582","044799","055410","10308822","10308987","055346","11278368","10308586","000862","10313706","10240159","10309090","10302544","001589","10313419","10313343","10313372","055464","10302407","10313869","13467535","11278283","10308878","11278442","055728","055481","11278332","10302431","10302451","10313320","000930","055704","10302392","001105","10313325","10308552","10372600","10308579","10308750","055434","055497","10352346","055473","10731761","10731780","10313863","10309158","10309157","000883","10302595","003322","10302345","055363","13467539","001077","10240252","10308512","000884","10308570","10731881","10309115","11278374","10313478","10302569","10308493","10308809","000907","10352401","055458","000382","001011","10240257","055585","10308468","10313433","10302462","000416","10137193","000820","055544","10302414","10313751","10313482","055170","055773","10372548","055665","055227","055377","055350"],"supplyCodes":["10008"]}
res = requests.post(url, headers = header, json=data).json()
for i in res['retData']:
    if i['skuNo'] == '10302592':
        print(i['supplyProductInfo']['saleAreaShortNames'], len(i['supplyProductInfo']['saleAreaShortNames']))



